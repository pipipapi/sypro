<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- tuser_trole -->

<mapper namespace="sy.model.po.TresourcePo">

    <resultMap id="ExtendResultMap" extends="BaseResultMap" type="sy.model.po.TresourcePo">
        <collection property="resourcetypes" column="TRESOURCETYPE_ID" javaType="java.util.Set" select="sy.model.po.TresourcetypePo.selectResourceTypes"/>
    </resultMap>

    <select id="selectMyResourceForTree" resultMap="ExtendResultMap" parameterType="java.util.Map">
        select
        re.id,re.icon,re.NAME,re.REMARK,re.SEQ,re.URL,re.PID,re.TRESOURCETYPE_ID
        from   trole_tresource tr
        left join tresource re on re.id=tr.tresource_id
        left join tuser_trole u on u.trole_id=tr.trole_id
        where u.tuser_id = #{userId} and re.TRESOURCETYPE_ID=0
        order by re.seq
    </select>


    <select id="selectMyResource" resultMap="ExtendResultMap" parameterType="java.util.Map">
        select
        re.id,re.icon,re.NAME,re.REMARK,re.SEQ,re.URL,re.PID,re.TRESOURCETYPE_ID
        from   trole_tresource tr
        left join tresource re on re.id=tr.tresource_id
        left join tuser_trole u on u.trole_id=tr.trole_id
        where u.trole_id = #{roleId}
        order by re.seq
    </select>

</mapper>